---
layout: default
title: Архитектура системы
nav_order: 2
---

# Описания DFD-диаграмм 0 и 1 уровня

---

## Описание DFD-диаграммы 0 уровня (общая структура системы):

---

![dfd 0 уровня](images/dfd0.png)

### 1. Основные компоненты системы:  
1. Пользователь  
   - Инициирует действия:  
     - Отправка запросов на просмотр данных  
     - Загрузка отзывов и изображений  

2. Агрегатор отзывов  
   - Центральный процесс, обрабатывающий следующие запросы:  
     - Приём и обработка запросов пользователя
     - Формирование ответов (например, вывод отзывов, подтверждение загрузки)

---

### 2. Потоки данных:  
- Пользователь → Агрегатор:  
  - Запрос на чтение информации
  - Загрузка отзыва
  - Загрузка изображения

- Агрегатор → Пользователь:  
  - Ответ с результатами (список отзывов, подтверждение успешной операции и т.д.)  

---

### 3. Общая логика работы системы:  
1. Запрос пользователя:  
   - Пользователь отправляет запрос  
2. Обработка агрегатором:  
   - Агрегатор принимает данные, обрабатывает запрос и формирует ответ  
3. Возврат результата:  
   - Пользователь получает отформатированный ответ

## Описание DFD-диаграммы 1 уровня для документации

---

![dfd 1 уровня](images/dfd1.png)

### 1. Основные компоненты системы:  
1. Пользователь  
   - Взаимодействует с системой через процессы:  
     - Отправка запросов (просмотр данных, регистрация, аутентификация)
     - Загрузка отзывов и изображений

2. Процессы системы:  
   - Процесс получения и выборки данных:  
     - Обрабатывает запросы на чтение  
     - Выполняет фильтрацию и сортировку данных  
   - Процесс работы с отзывами (только если пользователь зарегистрирован):  
     - Сохраняет/редактирует отзывы в базе данных  
     - Генерирует статусы операций (успех/ошибка)  
   - Процесс загрузки файлов (только если пользователь зарегистрирован):  
     - Передает файлы в Cloud Storage  
     - Формирует URL-ссылки на загруженные файлы  
   - Процесс аутентификации:  
     - Проверяет логин/пароль пользователя  
     - Управляет сессиями (создание/закрытие)  
   - Процесс регистрации:  
     - Проверяет уникальность данных (логин, email) 
     - Сохраняет данные в Firebase  

3. Внешние сущности:  
   - База данных:  
     - Хранит информацию об организациях и отзывах
   - Cloud Storage Server:  
     - Хранит изображения
   - Firebase:  
     - Хранит логины, пароли и сессионные ключи

---

### 2. Потоки данных:  
#### **Регистрация**:  
- **Пользователь → Процесс регистрации**:  
  - Пользователь отправляет данные: логин, пароль  
- **Процесс регистрации → Firebase**:  
  - Проверка уникальности логина/email  
- **Firebase → Процесс регистрации**:  
  - Ответ: данные уникальны/заняты
- **Процесс регистрации → Пользователь**:  
  - Результат: успешная регистрация или сообщение об ошибке (например, «логин занят»)  

---

#### **Аутентификация**:  
- **Пользователь → Процесс аутентификации**:  
  - Пользователь вводит логин и пароль  
- **Процесс аутентификации → Firebase**:  
  - Проверка логина/email и пароля  
- **Firebase → Процесс аутентификации**:  
  - Ответ: данные валидны/неверны
- **Процесс аутентификации → Пользователь**:  
  - Результат: авторизация успешна (с токеном) или ошибка («неверный пароль»)  

---

#### **Получение и выборка данных**:  
- **Пользователь → Процесс получения данных**:  
  - Запрос на просмотр (например, «отзывы по организации»)  
- **Процесс получения данных → База данных**:  
  - Передача условий фильтрации (организация, дата, рейтинг) 
- **База данных → Процесс получения данных**:  
  - Возврат отфильтрованных данных (текст, метаданные, ссылки на файлы)  
- **Процесс получения данных → Пользователь**:  
  - Результат: список отзывов с деталями (текст, организация, дата, рейтинг, файлы) 

---

#### **Работа с отзывами (только для зарегистрированных пользователей)**:  
- **Пользователь → Процесс работы с отзывами**:  
  - Отправка текста отзыва
- **Процесс работы с отзывами → База данных**:  
  - Сохранение текста отзыва + URL-ссылки (если был файл)  
- **База данных → Процесс работы с отзывами**:  
  - Подтверждение сохранения  
- **Процесс работы с отзывами → Пользователь**:  
  - Результат: отзыв добавлен или ошибка 

---

#### **Загрузка файлов (только для зарегистрированных пользователей)**:  
- **Пользователь → Процесс загрузки файлов**:  
  - Передача изображения  
- **Процесс загрузки файлов → Cloud Storage Server**:  
  - Загрузка файла в облачное хранилище  
- **Cloud Storage Server → Процесс загрузки файлов**:  
  - Генерация уникальной URL-ссылки на файл  
- **Процесс загрузки файлов → База данных**:  
  - Передача URL-ссылки на изображение в базу данных  
- **Процесс загрузки файлов → Пользователь**:  
  - Подтверждение загрузки картинки или ошибка
  
---

### 3. Общая логика работы системы:  
1. Регистрация/аутентификация:  
   - Пользователь предоставляет данные (логин, пароль)  
   - Система проверяет уникальность данных при регистрации или подтверждает их при аутентификации через Firebase. 
2. Работа с отзывами:  
   - Пользователь отправляет текст и/или файл 
   - Агрегатор сохраняет текст в базу данных, файл — в Cloud Storage  
   - Формируется URL-ссылка на файл и возвращается пользователю  
3. Просмотр данных:  
   - Пользователь задает критерии отбора (например, организация, дата)  
   - Система фильтрует данные из базы и выводит результат  

